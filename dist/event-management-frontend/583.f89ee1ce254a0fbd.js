"use strict";(self.webpackChunkevent_management_frontend=self.webpackChunkevent_management_frontend||[]).push([[583],{2583:(W,g,s)=>{s.r(g),s.d(g,{AdminComponent:()=>V});var m=s(177),p=s(7062),l=s(5596),u=s(8834),v=s(9213),f=s(9183),d=s(9417),_=s(882),E=s(9631),k=s(5416),t=s(7705),h=s(9486),F=s(369),C=s(4312);function j(e,r){if(1&e){const n=t.RV6();t.j41(0,"div",15)(1,"h2"),t.EFF(2,"Create Event (Admin)"),t.k0s(),t.j41(3,"mat-card")(4,"form",16,17),t.bIt("ngSubmit",function(){t.eBV(n);const o=t.XpG();return t.Njj(o.createEvent())}),t.j41(6,"mat-card-content")(7,"div",18)(8,"mat-form-field",19)(9,"mat-label"),t.EFF(10,"Title"),t.k0s(),t.j41(11,"input",20),t.bIt("ngModelChange",function(o){t.eBV(n);const a=t.XpG();return t.Njj(a.form.title=o)}),t.k0s()(),t.j41(12,"mat-form-field",19)(13,"mat-label"),t.EFF(14,"Description"),t.k0s(),t.j41(15,"textarea",21),t.bIt("ngModelChange",function(o){t.eBV(n);const a=t.XpG();return t.Njj(a.form.description=o)}),t.k0s()(),t.j41(16,"mat-form-field",19)(17,"mat-label"),t.EFF(18,"Start Date & Time"),t.k0s(),t.j41(19,"input",22),t.bIt("ngModelChange",function(o){t.eBV(n);const a=t.XpG();return t.Njj(a.form.startDateTime=o)}),t.k0s()(),t.j41(20,"mat-form-field",19)(21,"mat-label"),t.EFF(22,"End Date & Time"),t.k0s(),t.j41(23,"input",23),t.bIt("ngModelChange",function(o){t.eBV(n);const a=t.XpG();return t.Njj(a.form.endDateTime=o)}),t.k0s()(),t.j41(24,"mat-form-field",19)(25,"mat-label"),t.EFF(26,"Location"),t.k0s(),t.j41(27,"input",24),t.bIt("ngModelChange",function(o){t.eBV(n);const a=t.XpG();return t.Njj(a.form.location=o)}),t.k0s()(),t.j41(28,"mat-form-field",19)(29,"mat-label"),t.EFF(30,"Max Attendees"),t.k0s(),t.j41(31,"input",25),t.bIt("ngModelChange",function(o){t.eBV(n);const a=t.XpG();return t.Njj(a.form.maxAttendees=o)}),t.k0s()(),t.j41(32,"mat-form-field",19)(33,"mat-label"),t.EFF(34,"Ticket Price"),t.k0s(),t.j41(35,"input",26),t.bIt("ngModelChange",function(o){t.eBV(n);const a=t.XpG();return t.Njj(a.form.ticketPrice=o)}),t.k0s()(),t.j41(36,"mat-form-field",19)(37,"mat-label"),t.EFF(38,"Image URL"),t.k0s(),t.j41(39,"input",27),t.bIt("ngModelChange",function(o){t.eBV(n);const a=t.XpG();return t.Njj(a.form.imageUrl=o)}),t.k0s()(),t.j41(40,"mat-form-field",19)(41,"mat-label"),t.EFF(42,"Category ID"),t.k0s(),t.j41(43,"input",28),t.bIt("ngModelChange",function(o){t.eBV(n);const a=t.XpG();return t.Njj(a.form.categoryId=o)}),t.k0s()()()(),t.j41(44,"mat-card-actions")(45,"button",29)(46,"mat-icon"),t.EFF(47,"save"),t.k0s(),t.EFF(48),t.k0s()()()()()}if(2&e){const n=t.sdS(5),i=t.XpG();t.R7$(11),t.Y8G("ngModel",i.form.title),t.R7$(4),t.Y8G("ngModel",i.form.description),t.R7$(4),t.Y8G("ngModel",i.form.startDateTime),t.R7$(4),t.Y8G("ngModel",i.form.endDateTime),t.R7$(4),t.Y8G("ngModel",i.form.location),t.R7$(4),t.Y8G("ngModel",i.form.maxAttendees),t.R7$(4),t.Y8G("ngModel",i.form.ticketPrice),t.R7$(4),t.Y8G("ngModel",i.form.imageUrl),t.R7$(4),t.Y8G("ngModel",i.form.categoryId),t.R7$(2),t.Y8G("disabled",n.invalid||i.isCreating),t.R7$(3),t.SpI(" ",i.isCreating?"Creating...":"Create Event"," ")}}function b(e,r){1&e&&(t.j41(0,"div",30),t.nrm(1,"mat-spinner"),t.k0s())}const M=function(e){return["/edit-event",e]};function A(e,r){if(1&e&&(t.j41(0,"button",33),t.EFF(1,"Edit"),t.k0s()),2&e){const n=t.XpG().$implicit;t.Y8G("routerLink",t.eq3(1,M,n.id))}}function x(e,r){if(1&e){const n=t.RV6();t.j41(0,"button",36),t.bIt("click",function(o){t.eBV(n);const a=t.XpG().$implicit,c=t.XpG(2);return o.stopPropagation(),t.Njj(c.deleteEvent(a.id))}),t.j41(1,"mat-icon"),t.EFF(2,"delete"),t.k0s(),t.EFF(3," Delete "),t.k0s()}}const I=function(e){return["/events",e]};function T(e,r){if(1&e&&(t.j41(0,"mat-card")(1,"mat-card-content")(2,"h3"),t.EFF(3),t.k0s(),t.j41(4,"p"),t.EFF(5),t.nI1(6,"date"),t.k0s(),t.j41(7,"p"),t.EFF(8),t.k0s()(),t.j41(9,"mat-card-actions")(10,"button",33),t.EFF(11,"View"),t.k0s(),t.DNE(12,A,2,3,"button",34),t.DNE(13,x,4,0,"button",35),t.k0s()()),2&e){const n=r.$implicit,i=t.XpG(2);t.R7$(3),t.JRh(n.title),t.R7$(2),t.Lme("",n.location," | ",t.i5U(6,7,n.startDateTime,"medium"),""),t.R7$(3),t.SpI("Status: ",n.status,""),t.R7$(2),t.Y8G("routerLink",t.eq3(10,I,n.id)),t.R7$(2),t.Y8G("ngIf",i.authService.isAdmin()),t.R7$(1),t.Y8G("ngIf",i.authService.isAdmin())}}function P(e,r){if(1&e&&(t.j41(0,"div",31),t.DNE(1,T,14,12,"mat-card",32),t.k0s()),2&e){const n=t.XpG();t.R7$(1),t.Y8G("ngForOf",n.allEvents)}}function D(e,r){1&e&&(t.j41(0,"div",37)(1,"p"),t.EFF(2,"No events found."),t.k0s()())}function B(e,r){1&e&&(t.j41(0,"div",30),t.nrm(1,"mat-spinner"),t.k0s())}function R(e,r){if(1&e){const n=t.RV6();t.j41(0,"mat-card")(1,"mat-card-content")(2,"h3"),t.EFF(3),t.k0s(),t.j41(4,"p"),t.EFF(5),t.nI1(6,"date"),t.k0s(),t.j41(7,"p"),t.EFF(8),t.k0s()(),t.j41(9,"mat-card-actions")(10,"button",41),t.bIt("click",function(){const a=t.eBV(n).$implicit,c=t.XpG(3);return t.Njj(c.approve(a))}),t.EFF(11,"Approve"),t.k0s(),t.j41(12,"button",36),t.bIt("click",function(){const a=t.eBV(n).$implicit,c=t.XpG(3);return t.Njj(c.reject(a))}),t.EFF(13,"Reject"),t.k0s()()()}if(2&e){const n=r.$implicit;t.R7$(3),t.JRh(n.title),t.R7$(2),t.Lme("",n.location," | ",t.i5U(6,4,n.startDateTime,"medium"),""),t.R7$(3),t.SpI("Status: ",n.status,"")}}function G(e,r){if(1&e&&(t.j41(0,"div",40),t.DNE(1,R,14,7,"mat-card",32),t.k0s()),2&e){const n=t.XpG(2);t.R7$(1),t.Y8G("ngForOf",n.pendingEvents)}}function y(e,r){1&e&&(t.j41(0,"div",37)(1,"p"),t.EFF(2,"No pending events."),t.k0s()())}function $(e,r){if(1&e&&(t.j41(0,"div",38)(1,"h2"),t.EFF(2,"Pending Events"),t.k0s(),t.DNE(3,B,2,0,"div",11),t.DNE(4,G,2,1,"div",39),t.DNE(5,y,3,0,"div",13),t.k0s()),2&e){const n=t.XpG();t.R7$(3),t.Y8G("ngIf",n.loadingPending),t.R7$(1),t.Y8G("ngIf",!n.loadingPending&&n.pendingEvents.length>0),t.R7$(1),t.Y8G("ngIf",!n.loadingPending&&0===n.pendingEvents.length)}}function O(e,r){1&e&&(t.j41(0,"div",30),t.nrm(1,"mat-spinner"),t.k0s())}function N(e,r){if(1&e){const n=t.RV6();t.j41(0,"mat-card")(1,"mat-card-content")(2,"h3"),t.EFF(3),t.k0s(),t.j41(4,"p"),t.EFF(5),t.nI1(6,"currency"),t.k0s()(),t.j41(7,"mat-card-actions")(8,"button",41),t.bIt("click",function(){const a=t.eBV(n).$implicit,c=t.XpG(3);return t.Njj(c.approveBooking(a))}),t.EFF(9,"Approve"),t.k0s(),t.j41(10,"button",36),t.bIt("click",function(){const a=t.eBV(n).$implicit,c=t.XpG(3);return t.Njj(c.cancelBooking(a))}),t.EFF(11,"Cancel"),t.k0s()()()}if(2&e){const n=r.$implicit;t.R7$(3),t.JRh(n.event.title),t.R7$(2),t.LHq("User: ",n.user.username," | Tickets: ",n.numberOfTickets," | Amount: ",t.bMT(6,5,n.totalAmount)," | Status: ",n.status,"")}}function S(e,r){if(1&e&&(t.j41(0,"div",40),t.DNE(1,N,12,7,"mat-card",32),t.k0s()),2&e){const n=t.XpG(2);t.R7$(1),t.Y8G("ngForOf",n.pendingBookings)}}function Y(e,r){1&e&&(t.j41(0,"div",37)(1,"p"),t.EFF(2,"No pending bookings."),t.k0s()())}function U(e,r){if(1&e&&(t.j41(0,"div",38)(1,"h2"),t.EFF(2,"Pending Bookings"),t.k0s(),t.DNE(3,O,2,0,"div",11),t.DNE(4,S,2,1,"div",39),t.DNE(5,Y,3,0,"div",13),t.k0s()),2&e){const n=t.XpG();t.R7$(3),t.Y8G("ngIf",n.loadingBookings),t.R7$(1),t.Y8G("ngIf",!n.loadingBookings&&n.pendingBookings.length>0),t.R7$(1),t.Y8G("ngIf",!n.loadingBookings&&0===n.pendingBookings.length)}}const L=function(){return["/create-event"]},X=function(){return{admin:!0}};let V=(()=>{class e{constructor(n,i,o,a){this.eventService=n,this.bookingService=i,this.authService=o,this.snackBar=a,this.pendingEvents=[],this.loadingPending=!1,this.deletingEvent=!1,this.allEvents=[],this.loadingAll=!1,this.pendingBookings=[],this.loadingBookings=!1,this.isCreating=!1,this.form={title:"",description:"",startDateTime:"",endDateTime:"",location:"",maxAttendees:1,ticketPrice:0,imageUrl:"",categoryId:1}}ngOnInit(){this.loadAll(),this.loadPending(),this.loadPendingBookings()}loadPending(){if(!this.authService.isAdmin())return this.pendingEvents=[],void(this.loadingPending=!1);this.loadingPending=!0,this.eventService.getPendingEvents(0,50,"createdAt","desc").subscribe({next:n=>{this.pendingEvents=n?.content||[],this.loadingPending=!1},error:()=>{this.loadingPending=!1}})}loadAll(){this.loadingAll=!0,this.eventService.getEvents(0,50,"startDateTime","asc").subscribe({next:n=>{this.allEvents=n?.content||[],this.loadingAll=!1},error:()=>{this.loadingAll=!1}})}loadPendingBookings(){if(!this.authService.isAdmin())return this.pendingBookings=[],void(this.loadingBookings=!1);this.loadingBookings=!0,this.bookingService.getBookings(0,100).subscribe({next:n=>{this.pendingBookings=(n?.content||n||[]||[]).filter(o=>"PENDING"===String(o.status).toUpperCase()),this.loadingBookings=!1},error:()=>{this.loadingBookings=!1}})}approveBooking(n){n?.id&&this.bookingService.confirmBooking(Number(n.id)).subscribe({next:()=>{this.snackBar.open("Booking approved.","Close",{duration:3e3}),this.loadPendingBookings()}})}cancelBooking(n){n?.id&&this.bookingService.cancelBooking(Number(n.id)).subscribe({next:()=>{this.snackBar.open("Booking cancelled.","Close",{duration:3e3}),this.loadPendingBookings()}})}approve(n){this.eventService.approveEvent(n.id).subscribe({next:()=>this.loadPending()})}reject(n){this.eventService.rejectEvent(n.id).subscribe({next:()=>this.loadPending()})}deleteEvent(n){confirm("Are you sure you want to delete this event? This action cannot be undone.")&&(this.deletingEvent=!0,this.eventService.deleteEvent(n).subscribe({next:()=>{this.allEvents=this.allEvents.filter(i=>i.id!==n),this.pendingEvents=this.pendingEvents.filter(i=>i.id!==n),this.snackBar.open("Event deleted successfully","Close",{duration:3e3}),this.deletingEvent=!1},error:i=>{console.error("Error deleting event:",i),this.snackBar.open("Failed to delete event","Close",{duration:3e3}),this.deletingEvent=!1}}))}toBackendDate(n){return n?/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}$/.test(n)?`${n}:00`:n:""}createEvent(){if(this.isCreating)return;this.isCreating=!0;const n={...this.form,startDateTime:this.toBackendDate(this.form.startDateTime),endDateTime:this.toBackendDate(this.form.endDateTime),maxAttendees:Number(this.form.maxAttendees),ticketPrice:Number(this.form.ticketPrice),categoryId:Number(this.form.categoryId)};this.eventService.createEvent(n).subscribe({next:()=>{this.isCreating=!1,this.snackBar.open("Event created successfully.","Close",{duration:3e3}),this.form={title:"",description:"",startDateTime:"",endDateTime:"",location:"",maxAttendees:1,ticketPrice:0,imageUrl:"",categoryId:1},this.loadAll()},error:i=>{this.isCreating=!1,this.snackBar.open(String(i&&i.error&&(i.error.message||i.error.error||i.error)||"Failed to create event."),"Close",{duration:5e3})}})}static{this.\u0275fac=function(i){return new(i||e)(t.rXU(h.U),t.rXU(F.L),t.rXU(C.u),t.rXU(k.UG))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-admin"]],standalone:!0,features:[t.aNF],decls:77,vars:10,consts:[[1,"container"],[1,"admin-grid"],["mat-raised-button","","color","primary"],["mat-raised-button","","color","primary","routerLink","/events"],["mat-stroked-button","","color","accent",3,"routerLink","queryParams"],["mat-stroked-button","","color","primary","routerLink","/events"],["mat-stroked-button","","color","primary","routerLink","/my-bookings"],["mat-stroked-button","","color","primary","routerLink","/my-events"],["mat-stroked-button","","color","primary","routerLink","/profile"],["class","create-section",4,"ngIf"],[1,"all-section"],["class","loading",4,"ngIf"],["class","all-grid",4,"ngIf"],["class","empty",4,"ngIf"],["class","pending-section",4,"ngIf"],[1,"create-section"],[3,"ngSubmit"],["f","ngForm"],[1,"grid"],["appearance","outline"],["matInput","","name","title","required","",3,"ngModel","ngModelChange"],["matInput","","name","description",3,"ngModel","ngModelChange"],["matInput","","type","datetime-local","name","startDateTime","required","",3,"ngModel","ngModelChange"],["matInput","","type","datetime-local","name","endDateTime","required","",3,"ngModel","ngModelChange"],["matInput","","name","location","required","",3,"ngModel","ngModelChange"],["matInput","","type","number","name","maxAttendees","min","1","required","",3,"ngModel","ngModelChange"],["matInput","","type","number","step","0.01","name","ticketPrice","required","",3,"ngModel","ngModelChange"],["matInput","","name","imageUrl",3,"ngModel","ngModelChange"],["matInput","","type","number","name","categoryId","required","",3,"ngModel","ngModelChange"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"loading"],[1,"all-grid"],[4,"ngFor","ngForOf"],["mat-button","","color","primary",3,"routerLink"],["mat-button","","color","primary",3,"routerLink",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","color","warn",3,"click"],[1,"empty"],[1,"pending-section"],["class","pending-grid",4,"ngIf"],[1,"pending-grid"],["mat-raised-button","","color","primary",3,"click"]],template:function(i,o){1&i&&(t.j41(0,"div",0)(1,"h1"),t.EFF(2,"Admin Panel"),t.k0s(),t.j41(3,"p"),t.EFF(4,"Manage users, events, and categories"),t.k0s(),t.j41(5,"div",1)(6,"mat-card")(7,"mat-card-content")(8,"mat-icon"),t.EFF(9,"people"),t.k0s(),t.j41(10,"h3"),t.EFF(11,"Users"),t.k0s(),t.j41(12,"p"),t.EFF(13,"Manage user accounts"),t.k0s()(),t.j41(14,"mat-card-actions")(15,"button",2),t.EFF(16,"Manage Users"),t.k0s()()(),t.j41(17,"mat-card")(18,"mat-card-content")(19,"mat-icon"),t.EFF(20,"event"),t.k0s(),t.j41(21,"h3"),t.EFF(22,"Events"),t.k0s(),t.j41(23,"p"),t.EFF(24,"Manage all events"),t.k0s()(),t.j41(25,"mat-card-actions")(26,"button",3),t.EFF(27,"Manage Events"),t.k0s(),t.j41(28,"button",4)(29,"mat-icon"),t.EFF(30,"add"),t.k0s(),t.EFF(31," Create Event "),t.k0s()()(),t.j41(32,"mat-card")(33,"mat-card-content")(34,"mat-icon"),t.EFF(35,"bolt"),t.k0s(),t.j41(36,"h3"),t.EFF(37,"Quick Actions"),t.k0s(),t.j41(38,"p"),t.EFF(39,"Common user actions available from here"),t.k0s()(),t.j41(40,"mat-card-actions")(41,"button",5)(42,"mat-icon"),t.EFF(43,"event"),t.k0s(),t.EFF(44," Browse Events "),t.k0s(),t.j41(45,"button",6)(46,"mat-icon"),t.EFF(47,"book_online"),t.k0s(),t.EFF(48," My Bookings "),t.k0s(),t.j41(49,"button",7)(50,"mat-icon"),t.EFF(51,"inventory_2"),t.k0s(),t.EFF(52," My Events "),t.k0s(),t.j41(53,"button",8)(54,"mat-icon"),t.EFF(55,"person"),t.k0s(),t.EFF(56," Profile "),t.k0s()()(),t.j41(57,"mat-card")(58,"mat-card-content")(59,"mat-icon"),t.EFF(60,"category"),t.k0s(),t.j41(61,"h3"),t.EFF(62,"Categories"),t.k0s(),t.j41(63,"p"),t.EFF(64,"Manage event categories"),t.k0s()(),t.j41(65,"mat-card-actions")(66,"button",2),t.EFF(67,"Manage Categories"),t.k0s()()()(),t.DNE(68,j,49,11,"div",9),t.j41(69,"div",10)(70,"h2"),t.EFF(71,"All Events"),t.k0s(),t.DNE(72,b,2,0,"div",11),t.DNE(73,P,2,1,"div",12),t.DNE(74,D,3,0,"div",13),t.k0s(),t.DNE(75,$,6,3,"div",14),t.DNE(76,U,6,3,"div",14),t.k0s()),2&i&&(t.R7$(28),t.Y8G("routerLink",t.lJ4(8,L))("queryParams",t.lJ4(9,X)),t.R7$(40),t.Y8G("ngIf",o.authService.isAdmin()),t.R7$(4),t.Y8G("ngIf",o.loadingAll),t.R7$(1),t.Y8G("ngIf",!o.loadingAll&&o.allEvents.length>0),t.R7$(1),t.Y8G("ngIf",!o.loadingAll&&0===o.allEvents.length),t.R7$(1),t.Y8G("ngIf",o.authService.isAdmin()),t.R7$(1),t.Y8G("ngIf",o.authService.isAdmin()))},dependencies:[m.MD,m.Sq,m.bT,m.oe,m.vh,p.iI,p.Wk,d.YN,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.VZ,d.vS,d.cV,l.Hu,l.RN,l.YY,l.m2,u.Hl,u.$z,v.m_,v.An,f.D6,f.LG,_.RG,_.rl,_.nJ,E.fS,E.fg,k._T],styles:[".container[_ngcontent-%COMP%]{padding:40px 20px}.admin-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px;margin-top:32px}.admin-grid[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{text-align:center}.admin-grid[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;color:#1976d2;margin-bottom:16px}.create-section[_ngcontent-%COMP%]{margin-top:40px}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px}.pending-section[_ngcontent-%COMP%]{margin-top:40px}.pending-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:16px}.all-section[_ngcontent-%COMP%]{margin-top:40px}.all-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:16px}.loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:24px}.empty[_ngcontent-%COMP%]{color:#666;margin-top:8px}"]})}}return e})()}}]);